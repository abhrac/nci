Environment:
	Python: 3.9.12
	PyTorch: 2.0.1+cu117
	Torchvision: 0.15.2+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.25.0
	PIL: 10.0.0
Args:
	algorithm: nci
	batch_size: 32
	checkpoint_freq: None
	data_dir: None
	dataset: RotatedMNIST
	device: 0
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 64
	class_balanced: False
	data_augmentation: True
	lr: 0.001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0
Traceback (most recent call last):
  File "/home/achaudhuri/projects/nci/train.py", line 104, in <module>
    dataset = vars(datasets)[args.dataset](args.data_dir,
  File "/home/achaudhuri/projects/nci/datasets.py", line 167, in __init__
    super(RotatedMNIST, self).__init__(root, [0, 15, 30, 45, 60, 75],
  File "/home/achaudhuri/projects/nci/datasets.py", line 96, in __init__
    raise ValueError('Data directory not specified!')
ValueError: Data directory not specified!
Environment:
	Python: 3.9.12
	PyTorch: 2.0.1+cu117
	Torchvision: 0.15.2+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.25.0
	PIL: 10.0.0
Args:
	algorithm: nci
	batch_size: 32
	checkpoint_freq: None
	data_dir: /media/8TB_SSD/achaudhuri/datasets/domainbed/
	dataset: RotatedMNIST
	device: 0
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 64
	class_balanced: False
	data_augmentation: True
	lr: 0.001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0
Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz
Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to /media/8TB_SSD/achaudhuri/datasets/domainbed/MNIST/raw/train-images-idx3-ubyte.gz
  0%|          | 0/9912422 [00:00<?, ?it/s] 16%|#6        | 1605632/9912422 [00:00<00:00, 15889833.59it/s] 95%|#########5| 9437184/9912422 [00:00<00:00, 52452451.50it/s]100%|##########| 9912422/9912422 [00:00<00:00, 47760011.91it/s]
Extracting /media/8TB_SSD/achaudhuri/datasets/domainbed/MNIST/raw/train-images-idx3-ubyte.gz to /media/8TB_SSD/achaudhuri/datasets/domainbed/MNIST/raw

Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz
Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to /media/8TB_SSD/achaudhuri/datasets/domainbed/MNIST/raw/train-labels-idx1-ubyte.gz
  0%|          | 0/28881 [00:00<?, ?it/s]100%|##########| 28881/28881 [00:00<00:00, 67977381.49it/s]
Extracting /media/8TB_SSD/achaudhuri/datasets/domainbed/MNIST/raw/train-labels-idx1-ubyte.gz to /media/8TB_SSD/achaudhuri/datasets/domainbed/MNIST/raw

Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz
Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to /media/8TB_SSD/achaudhuri/datasets/domainbed/MNIST/raw/t10k-images-idx3-ubyte.gz
  0%|          | 0/1648877 [00:00<?, ?it/s]100%|##########| 1648877/1648877 [00:00<00:00, 26953922.71it/s]
Extracting /media/8TB_SSD/achaudhuri/datasets/domainbed/MNIST/raw/t10k-images-idx3-ubyte.gz to /media/8TB_SSD/achaudhuri/datasets/domainbed/MNIST/raw

Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz
Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to /media/8TB_SSD/achaudhuri/datasets/domainbed/MNIST/raw/t10k-labels-idx1-ubyte.gz
  0%|          | 0/4542 [00:00<?, ?it/s]100%|##########| 4542/4542 [00:00<00:00, 26459067.73it/s]
Extracting /media/8TB_SSD/achaudhuri/datasets/domainbed/MNIST/raw/t10k-labels-idx1-ubyte.gz to /media/8TB_SSD/achaudhuri/datasets/domainbed/MNIST/raw

Traceback (most recent call last):
  File "/home/achaudhuri/projects/nci/train.py", line 104, in <module>
    dataset = vars(datasets)[args.dataset](args.data_dir,
  File "/home/achaudhuri/projects/nci/datasets.py", line 167, in __init__
    super(RotatedMNIST, self).__init__(root, [0, 15, 30, 45, 60, 75],
  File "/home/achaudhuri/projects/nci/datasets.py", line 117, in __init__
    self.datasets.append(dataset_transform(images, labels, environments[i]))
  File "/home/achaudhuri/projects/nci/datasets.py", line 179, in rotate_dataset
    x[i] = rotation(images[i])
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torchvision/transforms/transforms.py", line 95, in __call__
    img = t(img)
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torchvision/transforms/transforms.py", line 137, in __call__
    return F.to_tensor(pic)
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torchvision/transforms/functional.py", line 139, in to_tensor
    if not (F_pil._is_pil_image(pic) or _is_numpy(pic)):
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torchvision/transforms/_functional_pil.py", line 16, in _is_pil_image
    if accimage is not None:
KeyboardInterrupt
Environment:
	Python: 3.9.12
	PyTorch: 2.0.1+cu117
	Torchvision: 0.15.2+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.25.0
	PIL: 10.0.0
Args:
	algorithm: nci
	batch_size: 32
	checkpoint_freq: None
	data_dir: /media/8TB_SSD/achaudhuri/datasets/domainbed/PACS
	dataset: RotatedMNIST
	device: 0
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 64
	class_balanced: False
	data_augmentation: True
	lr: 0.001
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0
Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz
Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to /media/8TB_SSD/achaudhuri/datasets/domainbed/PACS/MNIST/raw/train-images-idx3-ubyte.gz
  0%|          | 0/9912422 [00:00<?, ?it/s] 58%|#####7    | 5734400/9912422 [00:00<00:00, 57257914.58it/s]100%|##########| 9912422/9912422 [00:00<00:00, 69155118.13it/s]
Extracting /media/8TB_SSD/achaudhuri/datasets/domainbed/PACS/MNIST/raw/train-images-idx3-ubyte.gz to /media/8TB_SSD/achaudhuri/datasets/domainbed/PACS/MNIST/raw

Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz
Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to /media/8TB_SSD/achaudhuri/datasets/domainbed/PACS/MNIST/raw/train-labels-idx1-ubyte.gz
  0%|          | 0/28881 [00:00<?, ?it/s]100%|##########| 28881/28881 [00:00<00:00, 65978046.75it/s]
Extracting /media/8TB_SSD/achaudhuri/datasets/domainbed/PACS/MNIST/raw/train-labels-idx1-ubyte.gz to /media/8TB_SSD/achaudhuri/datasets/domainbed/PACS/MNIST/raw

Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz
Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to /media/8TB_SSD/achaudhuri/datasets/domainbed/PACS/MNIST/raw/t10k-images-idx3-ubyte.gz
  0%|          | 0/1648877 [00:00<?, ?it/s]100%|##########| 1648877/1648877 [00:00<00:00, 21443095.21it/s]
Extracting /media/8TB_SSD/achaudhuri/datasets/domainbed/PACS/MNIST/raw/t10k-images-idx3-ubyte.gz to /media/8TB_SSD/achaudhuri/datasets/domainbed/PACS/MNIST/raw

Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz
Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to /media/8TB_SSD/achaudhuri/datasets/domainbed/PACS/MNIST/raw/t10k-labels-idx1-ubyte.gz
  0%|          | 0/4542 [00:00<?, ?it/s]100%|##########| 4542/4542 [00:00<00:00, 21096931.08it/s]
Extracting /media/8TB_SSD/achaudhuri/datasets/domainbed/PACS/MNIST/raw/t10k-labels-idx1-ubyte.gz to /media/8TB_SSD/achaudhuri/datasets/domainbed/PACS/MNIST/raw

Traceback (most recent call last):
  File "/home/achaudhuri/projects/nci/train.py", line 104, in <module>
    dataset = vars(datasets)[args.dataset](args.data_dir,
  File "/home/achaudhuri/projects/nci/datasets.py", line 167, in __init__
    super(RotatedMNIST, self).__init__(root, [0, 15, 30, 45, 60, 75],
  File "/home/achaudhuri/projects/nci/datasets.py", line 117, in __init__
    self.datasets.append(dataset_transform(images, labels, environments[i]))
  File "/home/achaudhuri/projects/nci/datasets.py", line 179, in rotate_dataset
    x[i] = rotation(images[i])
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torchvision/transforms/transforms.py", line 95, in __call__
    img = t(img)
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torchvision/transforms/transforms.py", line 234, in __call__
    return F.to_pil_image(pic, self.mode)
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torchvision/transforms/functional.py", line 259, in to_pil_image
    _log_api_usage_once(to_pil_image)
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torchvision/utils.py", line 561, in _log_api_usage_once
    name = obj.__name__
KeyboardInterrupt
Environment:
	Python: 3.9.12
	PyTorch: 2.0.1+cu117
	Torchvision: 0.15.2+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.25.0
	PIL: 10.0.0
Args:
	algorithm: nci
	batch_size: 32
	checkpoint_freq: None
	data_dir: /media/8TB_SSD/achaudhuri/datasets/domainbed/PACS
	dataset: PACS
	device: 0
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_adaptation
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0
Traceback (most recent call last):
  File "/home/achaudhuri/projects/nci/train.py", line 104, in <module>
    dataset = vars(datasets)[args.dataset](args.data_dir,
  File "/home/achaudhuri/projects/nci/datasets.py", line 239, in __init__
    super().__init__(self.dir, test_envs, hparams['data_augmentation'], hparams)
  File "/home/achaudhuri/projects/nci/datasets.py", line 189, in __init__
    environments = [f.name for f in os.scandir(root) if f.is_dir()]
FileNotFoundError: [Errno 2] No such file or directory: '/media/8TB_SSD/achaudhuri/datasets/domainbed/PACS/PACS/'
Environment:
	Python: 3.9.12
	PyTorch: 2.0.1+cu117
	Torchvision: 0.15.2+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.25.0
	PIL: 10.0.0
Args:
	algorithm: nci
	batch_size: 32
	checkpoint_freq: None
	data_dir: /media/8TB_SSD/achaudhuri/datasets/domainbed/
	dataset: PACS
	device: 0
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_adaptation
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0
Traceback (most recent call last):
  File "/home/achaudhuri/projects/nci/train.py", line 149, in <module>
    raise ValueError("Not enough unlabeled samples for domain adaptation.")
ValueError: Not enough unlabeled samples for domain adaptation.
Environment:
	Python: 3.9.12
	PyTorch: 2.0.1+cu117
	Torchvision: 0.15.2+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.25.0
	PIL: 10.0.0
Args:
	algorithm: nci
	batch_size: 32
	checkpoint_freq: None
	data_dir: /media/8TB_SSD/achaudhuri/datasets/domainbed/
	dataset: PACS
	device: 0
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0
Traceback (most recent call last):
  File "/home/achaudhuri/projects/nci/train.py", line 179, in <module>
    algorithm_class = algorithms.get_algorithm_class(args.algorithm)
  File "/home/achaudhuri/projects/nci/algorithms.py", line 19, in get_algorithm_class
    raise NotImplementedError("Algorithm not found: {}".format(algorithm_name))
NotImplementedError: Algorithm not found: nci
Environment:
	Python: 3.9.12
	PyTorch: 2.0.1+cu117
	Torchvision: 0.15.2+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.25.0
	PIL: 10.0.0
Args:
	algorithm: NCI
	batch_size: 32
	checkpoint_freq: None
	data_dir: /media/8TB_SSD/achaudhuri/datasets/domainbed/
	dataset: PACS
	device: 0
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0
/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Traceback (most recent call last):
  File "/home/achaudhuri/projects/nci/train.py", line 221, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)
  File "/home/achaudhuri/projects/nci/algorithms.py", line 130, in update
    features_tgt = self.featurizer(unlabeled[0])
TypeError: 'NoneType' object is not subscriptable
Environment:
	Python: 3.9.12
	PyTorch: 2.0.1+cu117
	Torchvision: 0.15.2+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.25.0
	PIL: 10.0.0
Args:
	algorithm: NCI
	batch_size: 32
	checkpoint_freq: None
	data_dir: /media/8TB_SSD/achaudhuri/datasets/domainbed/
	dataset: PACS
	device: 0
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_generalization
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0.1
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0
/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Traceback (most recent call last):
  File "/home/achaudhuri/projects/nci/train.py", line 221, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)
  File "/home/achaudhuri/projects/nci/algorithms.py", line 130, in update
    features_tgt = self.featurizer(unlabeled[0])
TypeError: 'NoneType' object is not subscriptable
Environment:
	Python: 3.9.12
	PyTorch: 2.0.1+cu117
	Torchvision: 0.15.2+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.25.0
	PIL: 10.0.0
Args:
	algorithm: NCI
	batch_size: 32
	checkpoint_freq: None
	data_dir: /media/8TB_SSD/achaudhuri/datasets/domainbed/
	dataset: PACS
	device: 0
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_adaptation
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0.1
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0
/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Traceback (most recent call last):
  File "/home/achaudhuri/projects/nci/train.py", line 238, in <module>
    acc = misc.accuracy(algorithm, loader, weights, device)
  File "/home/achaudhuri/projects/nci/lib/misc.py", line 194, in accuracy
    for x, y in loader:
  File "/home/achaudhuri/projects/nci/lib/fast_data_loader.py", line 70, in __iter__
    yield next(self._infinite_iterator)
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1328, in _next_data
    idx, data = self._get_data()
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1294, in _get_data
    success, data = self._try_get_data()
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1132, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/achaudhuri/anaconda3/lib/python3.9/multiprocessing/queues.py", line 113, in get
    if not self._poll(timeout):
  File "/home/achaudhuri/anaconda3/lib/python3.9/multiprocessing/connection.py", line 262, in poll
    return self._poll(timeout)
  File "/home/achaudhuri/anaconda3/lib/python3.9/multiprocessing/connection.py", line 429, in _poll
    r = wait([self], timeout)
  File "/home/achaudhuri/anaconda3/lib/python3.9/multiprocessing/connection.py", line 936, in wait
    ready = selector.select(timeout)
  File "/home/achaudhuri/anaconda3/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt
Environment:
	Python: 3.9.12
	PyTorch: 2.0.1+cu117
	Torchvision: 0.15.2+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.25.0
	PIL: 10.0.0
Args:
	algorithm: NCI
	batch_size: 128
	checkpoint_freq: None
	data_dir: /media/8TB_SSD/achaudhuri/datasets/domainbed/
	dataset: PACS
	device: 0
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_adaptation
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0.1
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0
/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Traceback (most recent call last):
  File "/home/achaudhuri/projects/nci/train.py", line 221, in <module>
    step_vals = algorithm.update(minibatches_device, uda_device)
  File "/home/achaudhuri/projects/nci/algorithms.py", line 117, in update
    all_features = self.featurizer(all_x)
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/achaudhuri/projects/nci/networks.py", line 104, in forward
    return self.dropout(self.network(x))
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torchvision/models/resnet.py", line 274, in _forward_impl
    x = self.layer2(x)
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torchvision/models/resnet.py", line 154, in forward
    out = self.conv3(out)
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 588.00 MiB (GPU 0; 23.69 GiB total capacity; 22.42 GiB already allocated; 50.56 MiB free; 22.46 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Environment:
	Python: 3.9.12
	PyTorch: 2.0.1+cu117
	Torchvision: 0.15.2+cu117
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.25.0
	PIL: 10.0.0
Args:
	algorithm: NCI
	batch_size: 64
	checkpoint_freq: None
	data_dir: /media/8TB_SSD/achaudhuri/datasets/domainbed/
	dataset: PACS
	device: 0
	holdout_fraction: 0.2
	hparams: None
	hparams_seed: 0
	output_dir: train_output
	save_model_every_checkpoint: False
	seed: 0
	skip_model_save: False
	steps: None
	task: domain_adaptation
	test_envs: [0]
	trial_seed: 0
	uda_holdout_fraction: 0.1
HParams:
	batch_size: 32
	class_balanced: False
	data_augmentation: True
	lr: 5e-05
	nonlinear_classifier: False
	resnet18: False
	resnet_dropout: 0.0
	weight_decay: 0.0
/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/achaudhuri/venvs/nci/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
env0_in_acc   env0_out_acc  env0_uda_acc  env1_in_acc   env1_out_acc  env2_in_acc   env2_out_acc  env3_in_acc   env3_out_acc  epoch         loss          mem_gb        nll           step          step_time    
0.2865853659  0.3056234719  0.3006134969  0.2830490405  0.3247863248  0.3622754491  0.3353293413  0.2140585242  0.2000000000  0.0000000000  2.5666666031  20.880653858  1.9843156338  0             2.4851751328 
0.7662601626  0.7701711491  0.7975460123  0.9546908316  0.9273504274  0.9940119760  0.9700598802  0.9545165394  0.9350318471  7.1856287425  0.4857131180  21.048348903  0.2531279425  300           0.5097705825 
0.6700542005  0.6919315403  0.6871165644  0.9685501066  0.9145299145  0.9820359281  0.9491017964  0.9481552163  0.9210191083  14.371257485  0.6036893815  21.048348903  0.1019970876  600           0.5159024970 
0.7527100271  0.7530562347  0.7914110429  0.9946695096  0.9444444444  0.9955089820  0.9790419162  0.9904580153  0.9605095541  21.556886227  0.6142942004  21.048348903  0.0934015091  900           0.5164414295 
0.8177506775  0.8459657702  0.8588957055  0.9973347548  0.9487179487  1.0000000000  0.9820359281  0.9942748092  0.9579617834  28.742514970  0.5655463201  21.048348903  0.0436662454  1200          0.5175639884 
0.8177506775  0.8386308068  0.8220858896  0.9994669510  0.9722222222  0.9992514970  0.9730538922  0.9968193384  0.9401273885  35.928143712  0.5325505342  21.048348903  0.0242688292  1500          0.5183225409 
0.8089430894  0.8166259169  0.8343558282  0.9936034115  0.9465811966  1.0000000000  0.9700598802  0.9955470738  0.9477707006  43.113772455  0.5184737695  21.048348903  0.0223014181  1800          0.5170718503 
0.7276422764  0.7506112469  0.7361963190  0.9957356077  0.9529914530  0.9977544910  0.9550898204  0.9885496183  0.9401273885  50.299401197  0.5084946010  21.048348903  0.0179105613  2100          0.5182015284 
0.7953929539  0.8019559902  0.8527607362  0.9962686567  0.9551282051  0.9955089820  0.9281437126  0.9920483461  0.9299363057  57.485029940  0.5107226068  21.048348903  0.0305088022  2400          0.5180769706 
0.7872628726  0.7970660147  0.8036809816  0.9930703625  0.9358974359  0.9985029940  0.9640718563  0.9844147583  0.9414012739  64.670658682  0.5267816680  21.048348903  0.0278595431  2700          0.5181278173 
0.8516260163  0.8704156479  0.8588957055  0.9973347548  0.9658119658  1.0000000000  0.9730538922  0.9990458015  0.9490445860  71.856287425  0.5236132942  21.048348903  0.0254286846  3000          0.5187957931 
0.8231707317  0.8484107579  0.8527607362  0.9994669510  0.9529914530  1.0000000000  0.9550898204  0.9977735369  0.9566878981  79.041916167  0.4981628612  21.048348903  0.0117084916  3300          0.5184177907 
0.7344173442  0.7677261614  0.7177914110  0.9866737740  0.9508547009  0.9767964072  0.9281437126  0.9907760814  0.9554140127  86.227544910  0.5234049941  21.048348903  0.0192594131  3600          0.5179365031 
0.8495934959  0.8581907090  0.8650306748  0.9984008529  0.9529914530  1.0000000000  0.9850299401  0.9980916031  0.9452229299  93.413173652  0.5154994236  21.048348903  0.0186264763  3900          0.5180282648 
0.7771002710  0.8092909535  0.8036809816  0.9989339019  0.9529914530  0.9992514970  0.9610778443  0.9971374046  0.9363057325  100.59880239  0.5078637076  21.048348903  0.0148178788  4200          0.5180263368 
0.8170731707  0.8533007335  0.7975460123  0.9978678038  0.9551282051  1.0000000000  0.9670658683  0.9974554707  0.9477707006  107.78443113  0.5107268282  21.048348903  0.0224634051  4500          0.5179294086 
0.8028455285  0.8386308068  0.8404907975  0.9989339019  0.9594017094  1.0000000000  0.9640718563  0.9996819338  0.9566878981  114.97005988  0.5183208155  21.048348903  0.0204608893  4800          0.5184467228 
0.8319783198  0.8410757946  0.8650306748  0.9989339019  0.9444444444  1.0000000000  0.9670658683  0.9971374046  0.9477707006  119.76047904  0.5072594552  21.048348903  0.0150603930  5000          0.5186646438 
